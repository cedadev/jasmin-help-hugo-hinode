---
description: Step-by-Step guide to setting up the NLDS client on JASMIN
title: NLDS Step by step
tags: nlds
---

{{<alert alert-type="info">}}
In December 2025, a more user friendly method of setting up the NLDS
client on JASMIN rolled out to NLDS users.

This guide has been updated to reflect this.
{{</alert>}}

## Prerequisites

This guide assumes that the user **already** has:

1. A JASMIN user account. See [Getting Started]({{% ref "get-started-with-jasmin#essential-steps" %}}).
2. Access to at least one Group Workspace. | See [Apply for access to a group workspace]({{% ref "apply-for-access-to-a-gws" %}})

With those in place, the remainder of this guide will take you through the following additional steps to access NLDS
as a JASMIN user:

1. Getting access to the NLDS object storage.
2. Installing the NLDS client.
3. Running the `nlds init` command.

## Access to the object storage

Data pushed to the NLDS service is initially written to a cache on object storage,
so you need to ensure that you have the appropriate access to write to that storage.
Similarly, when data is brought back from tape, it is initially written to the
object store cache before being made available to you

Normally, to gain access to object storage on JASMIN, you would need to apply for an
additional access role via the JASMIN Accounts Portal. However, this has now been
automated for the object storage used for the NLDS cache, so this is now tied to your
`jasmin-login` access role and is renewed whenever that role is renewed.

For further information about object storage on JASMIN, see
[Using the JASMIN Object Store](https://help.jasmin.ac.uk/docs/short-term-project-storage/using-the-jasmin-object-store/).

**So you now (already) have access to the object store tenancy for NLDS.**

{{<alert alert-type="info">}}
**As of December 2025**, the additional access role for access to the object store
is automatically granted, and the access and secret keys required by the object
store are automatically generated by the `nlds init` command. The
previous workflow of generating the object store access and secret
keys is **no longer required**.
{{</alert>}}

## Installing the NLDS client in your JASMIN home directory

First, please familiarise yourself with the JASMIN documentation on the
[sci servers]({{% ref "sci-servers" %}}).

We suggest that you use one of the `sci-vm-0x` servers to set up and use
the NLDS client. An alternative is to use one of the
[transfer servers]({{% ref "transfer-servers" %}}) (`xfer-vm-0x`), if it suits
your workflow more.

Creating the required virtual environment in your **home directory** will ensure that
it is available from both the scientific analysis servers or the
transfer servers.

1. Log into your chosen scientific analysis server:

{{<command user="localuser" host="localhost">}}
ssh <user>@sci-vm-01.jasmin.ac.uk
{{</command>}}

See [login servers]({{% ref "login-servers" %}}) for further detail on accessing
sci servers from outside of the STFC network.

2. Follow the NLDS client installation instructions:

Full documentation here: `NLDS : Docs : Installation<installation>`. 

The essential steps are reproduced below:

{{<command user="user" host="sci-vm-01">}}
cd $HOME           ## ensure that you are in your home directory
module load jaspy  ## ensure that you're using the current Python environment
python3 -m venv ~/nlds-client
source ~/nlds-client/bin/activate
pip install --upgrade pip
pip install nlds-client
{{</command>}}

{{<alert alert-type="info">}}
**As of December 2025** NLDS moved to using PyPi for hosting the NLDS
client, which makes installation much more straightforward for the
user, as `pip install nlds-client` can be used, rather than the long
GitHub URL as previously.
{{</alert>}}

## Configuring the NLDS client

{{<alert alert-type="info">}}
**As of December 2025** the NLDS client was improved so that the `nlds init`
command will now fill in all of the required values in the
`~/.nlds-config` file. This makes the setting up of the NLDS client
much more user friendly.
{{</alert>}}

1. First make sure your are running the `nlds-client`
   virtual-environment that you created above

   (**Tip:** try `echo $VIRTUAL_ENV`: is the returned path correct?).

   If you are not running it then issue the command:

{{<command>}}
source ~/nlds-client/bin/activate
{{</command>}}

2. Run NLDS with the `init` command to create your NLDS config file.
  This file will be in your home directory with the name
  `.nlds-config`. The full path is `~/.nlds-config`, also
  `$HOME/.nlds-config`. Use the `-g|--group` option to specify the
  default Group Workspace (GWS) when you are working with NLDS.

{{<command>}}
nlds init -g <default gws>
{{</command>}}

This will produce the following text, and the password prompt at the
end.

```text
Initialising the Near-line Data Store...
• This application uses OAuth2 to authenticate with the server on your behalf.
• To do this it needs your password.  Your password is not stored. 
• It is used to obtain an access token, which is stored in the file: ~/.nlds-token, and used for subsequent interactions with the server. 
• It is also used to obtain object storage keys.  These are stored in the configuration file: ~/.nlds-config and used for interaction with the object storage cache.

Password: 
```

Enter your JASMIN accounts portal password. The user name is automatically read
in from your JASMIN login username. The following text will be output:

```text
Successfully initialised, the config file at ~/.nlds-config has been updated with all of the necessary information to start using the NLDS.
```

You can now examine the config file with the following command (use your preferred editor, `nano` is used here):

{{<command>}}
nano ~/.nlds-config
{{</command>}}

The file should look like the example below. Fields between `< >`
characters should have values in them. If these fields contain the
characters `{{ }}` then please delete the `~/.nlds-config` file and try
`nlds init -g <gws>` again. If this fails again then please contact the
JASMIN helpdesk.

``` json
{
    "server": {
        "url": "https://nlds.jasmin.ac.uk",
        "api": "api/1.0.0"
    },
    "user": {
        "default_user": "< your JASMIN username >",
        "default_group": "< your default GWS >"
    },
    "authentication": {
        "oauth_client_id": "< redacted >",
        "oauth_client_secret": "< redacted >",
        "oauth_token_url": "< redacted >",
        "oauth_scopes": "< redacted >",
        "oauth_token_file_location": "~/.nlds-token"
    },
    "object_storage": {
        "tenancy": "nlds-cache-01.s3.jc.rl.ac.uk",
        "access_key": "< redacted >",
        "secret_key": "< redacted >"
    },
    "options": {
        "verify_certificates": true
    }
}
```

## Running the NLDS client for the first time

You should now have a fully configured and functioning NLDS client. You
can now run the NLDS client for the first time. Make sure the Python
virtual environment you created earlier is
activated first, then run `nlds` with the command `stat`.

You should see something similar to this:

{{<command>}}
source ~/nlds-client/bin/activate
nlds stat
(out)Usage: nlds stat [OPTIONS]
(out)Try 'nlds stat --help' for help.
(out)
(out)Error: Failed to get status of transaction(s) with user:<user>, group:<gws>
(out)Reason: no transaction records found for user:< user > and group:< gws >
{{</command>}}

Because you issued the `stat` command with `nlds`, the status of all
your NLDS requests will be shown. This is empty, as this is the first
time you have run NLDS, and the error message reflects this by stating
`no transaction records found`.

## Next steps

Now that you have the NLDS client set up on JASMIN, you can go through
the {{<link "https://cedadev.github.io/nlds-client/tutorial.html" >}}NLDS tutorial{{</link>}} (in NLDS docs).
